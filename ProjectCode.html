<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Susmi Sharma">

<title>Susmi Sharma - Code: Random Forest Model with All Features</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Susmi Sharma</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-knowledge-mining-project" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Knowledge Mining Project</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-knowledge-mining-project">    
        <li>
    <a class="dropdown-item" href="./ProjectCode.html" rel="" target="">
 <span class="dropdown-text">Model2 Code</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-assignments" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Assignments</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-assignments">    
        <li>
    <a class="dropdown-item" href="./Lab01.html" rel="" target="">
 <span class="dropdown-text">Assignment1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./Lab02.html" rel="" target="">
 <span class="dropdown-text">Assignment2</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#pre-processing-data" id="toc-pre-processing-data" class="nav-link active" data-scroll-target="#pre-processing-data">Pre-processing data</a>
  <ul class="collapse">
  <li><a href="#installing-necessary-packages" id="toc-installing-necessary-packages" class="nav-link" data-scroll-target="#installing-necessary-packages">Installing necessary packages</a></li>
  <li><a href="#loading-the-dataset" id="toc-loading-the-dataset" class="nav-link" data-scroll-target="#loading-the-dataset">Loading the dataset</a></li>
  <li><a href="#selecting-a-subset-of-participants-from-cvd-20000-participants" id="toc-selecting-a-subset-of-participants-from-cvd-20000-participants" class="nav-link" data-scroll-target="#selecting-a-subset-of-participants-from-cvd-20000-participants">Selecting a subset of participants from CVD: 20000 participants</a></li>
  <li><a href="#converting-age-from-range-to-numerical-value" id="toc-converting-age-from-range-to-numerical-value" class="nav-link" data-scroll-target="#converting-age-from-range-to-numerical-value">Converting Age from range to numerical value</a></li>
  <li><a href="#converting-the-variables-that-are-in-character-form-to-factors" id="toc-converting-the-variables-that-are-in-character-form-to-factors" class="nav-link" data-scroll-target="#converting-the-variables-that-are-in-character-form-to-factors">Converting the variables that are in character form to factors</a></li>
  <li><a href="#final-pre-processed-data" id="toc-final-pre-processed-data" class="nav-link" data-scroll-target="#final-pre-processed-data">Final Pre-processed data</a></li>
  <li><a href="#dependent-variable-vs-independent-variable-of-the-model" id="toc-dependent-variable-vs-independent-variable-of-the-model" class="nav-link" data-scroll-target="#dependent-variable-vs-independent-variable-of-the-model">Dependent variable vs independent variable of the model</a></li>
  <li><a href="#partitioning-of-the-data-into-trainingtesting-for-random-forest-model" id="toc-partitioning-of-the-data-into-trainingtesting-for-random-forest-model" class="nav-link" data-scroll-target="#partitioning-of-the-data-into-trainingtesting-for-random-forest-model">Partitioning of the data into training/testing for random forest model</a></li>
  </ul></li>
  <li><a href="#running-the-model" id="toc-running-the-model" class="nav-link" data-scroll-target="#running-the-model">Running the model</a>
  <ul class="collapse">
  <li><a href="#this-is-our-random-forest-model-with-all-features" id="toc-this-is-our-random-forest-model-with-all-features" class="nav-link" data-scroll-target="#this-is-our-random-forest-model-with-all-features">This is our random forest model with all features</a></li>
  <li><a href="#parameter-tuning" id="toc-parameter-tuning" class="nav-link" data-scroll-target="#parameter-tuning">Parameter Tuning</a></li>
  <li><a href="#we-will-record-the-out-of-bag-error-estimate-of-the-optimal-model" id="toc-we-will-record-the-out-of-bag-error-estimate-of-the-optimal-model" class="nav-link" data-scroll-target="#we-will-record-the-out-of-bag-error-estimate-of-the-optimal-model">We will record the out of bag error estimate of the optimal model</a></li>
  </ul></li>
  <li><a href="#model-features-and-performance" id="toc-model-features-and-performance" class="nav-link" data-scroll-target="#model-features-and-performance">Model Features and Performance</a>
  <ul class="collapse">
  <li><a href="#model-performance-on-the-testing-and-training-set" id="toc-model-performance-on-the-testing-and-training-set" class="nav-link" data-scroll-target="#model-performance-on-the-testing-and-training-set">Model Performance on the testing and training set</a></li>
  <li><a href="#which-variables-are-most-important-according-to-our-model" id="toc-which-variables-are-most-important-according-to-our-model" class="nav-link" data-scroll-target="#which-variables-are-most-important-according-to-our-model">Which variables are most important according to our model</a></li>
  <li><a href="#partial-depedence-plot" id="toc-partial-depedence-plot" class="nav-link" data-scroll-target="#partial-depedence-plot">Partial Depedence Plot</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Code: Random Forest Model with All Features</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Susmi Sharma </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="pre-processing-data" class="level1">
<h1>Pre-processing data</h1>
<section id="installing-necessary-packages" class="level3">
<h3 class="anchored" data-anchor-id="installing-necessary-packages">Installing necessary packages</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(setdiff(c("randomForest", "ggplot2", "caret","cowplot", "rfUtilities", </span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#                            "writexl"), rownames(installed.packages())))</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("writexl")</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randomForest)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>randomForest 4.7-1.1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Type rfNews() to see new features/changes/bug fixes.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: ggplot2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'ggplot2'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:randomForest':

    margin</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: lattice</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"dplyr"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:randomForest':

    combine</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"writexl"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="loading-the-dataset" class="level3">
<h3 class="anchored" data-anchor-id="loading-the-dataset">Loading the dataset</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>Heart_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"CVD_cleaned.csv"</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Heart_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  General_Health                 Checkup Exercise Heart_Disease Skin_Cancer
1           Poor Within the past 2 years       No            No          No
2      Very Good    Within the past year       No           Yes          No
3      Very Good    Within the past year      Yes            No          No
4           Poor    Within the past year      Yes           Yes          No
5           Good    Within the past year       No            No          No
6           Good    Within the past year       No            No          No
  Other_Cancer Depression Diabetes Arthritis    Sex Age_Category Height_.cm.
1           No         No       No       Yes Female        70-74         150
2           No         No      Yes        No Female        70-74         165
3           No         No      Yes        No Female        60-64         163
4           No         No      Yes        No   Male        75-79         180
5           No         No       No        No   Male          80+         191
6           No        Yes       No       Yes   Male        60-64         183
  Weight_.kg.   BMI Smoking_History Alcohol_Consumption Fruit_Consumption
1       32.66 14.54             Yes                   0                30
2       77.11 28.29              No                   0                30
3       88.45 33.47              No                   4                12
4       93.44 28.73              No                   0                30
5       88.45 24.37             Yes                   0                 8
6      154.22 46.11              No                   0                12
  Green_Vegetables_Consumption FriedPotato_Consumption
1                           16                      12
2                            0                       4
3                            3                      16
4                           30                       8
5                            4                       0
6                           12                      12</code></pre>
</div>
</div>
</section>
<section id="selecting-a-subset-of-participants-from-cvd-20000-participants" class="level3">
<h3 class="anchored" data-anchor-id="selecting-a-subset-of-participants-from-cvd-20000-participants">Selecting a subset of participants from CVD: 20000 participants</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>Number_ofparticipants <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="do">## This is a very large dataset, let's only select 10000 samples from both groups</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">150</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>Yes_case <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">which</span>(Heart_data<span class="sc">$</span>Heart_Disease <span class="sc">==</span> <span class="st">"Yes"</span>), Number_ofparticipants)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">150</span>)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>No_case <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">which</span>(Heart_data<span class="sc">$</span>Heart_Disease <span class="sc">==</span> <span class="st">"No"</span>), Number_ofparticipants)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>Data_yes <span class="ot">&lt;-</span> Heart_data[Yes_case, ]</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>Data_no <span class="ot">&lt;-</span>  Heart_data[No_case, ]</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>Data_total <span class="ot">&lt;-</span> <span class="fu">rbind</span>(Data_yes, Data_no)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Data_total)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       General_Health              Checkup Exercise Heart_Disease Skin_Cancer
43289            Poor Within the past year      Yes           Yes         Yes
281436           Fair Within the past year      Yes           Yes          No
196610           Fair Within the past year      Yes           Yes          No
306903           Fair Within the past year       No           Yes          No
304887           Poor Within the past year       No           Yes          No
278988           Fair Within the past year      Yes           Yes          No
       Other_Cancer Depression Diabetes Arthritis    Sex Age_Category
43289            No         No      Yes       Yes   Male        65-69
281436           No         No      Yes       Yes   Male        70-74
196610           No         No      Yes       Yes Female        40-44
306903          Yes         No      Yes       Yes Female        55-59
304887           No        Yes       No       Yes   Male          80+
278988           No         No       No        No   Male        50-54
       Height_.cm. Weight_.kg.   BMI Smoking_History Alcohol_Consumption
43289          175      102.97 33.52             Yes                   0
281436         170      104.33 36.02             Yes                   0
196610         180      136.08 41.84             Yes                   5
306903         160       65.77 25.69              No                   0
304887         155       62.60 26.07             Yes                   0
278988         180      106.59 32.78              No                  25
       Fruit_Consumption Green_Vegetables_Consumption FriedPotato_Consumption
43289                 12                           16                       3
281436                60                           30                       4
196610                60                            2                      12
306903                12                           12                       3
304887                28                           28                       4
278988                 3                            4                       8</code></pre>
</div>
</div>
</section>
<section id="converting-age-from-range-to-numerical-value" class="level3">
<h3 class="anchored" data-anchor-id="converting-age-from-range-to-numerical-value">Converting Age from range to numerical value</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="do">## We will convert the Age variable that is in range form in the dataset to a numerical form.</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>My_Age_Heart_Data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Data_total<span class="sc">$</span>Age_Category, Data_total<span class="sc">$</span>Heart_Disease)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(My_Age_Heart_Data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Age_Category"</span>, <span class="st">"Heart_Disease"</span>) </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co">#  This code gets the data in the right format</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>My_Age_Heart_Data<span class="sc">$</span>Age_min <span class="ot">&lt;-</span> </span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.numeric</span>(<span class="fu">substr</span>(My_Age_Heart_Data<span class="sc">$</span>Age_Category, <span class="at">start =</span> <span class="dv">1</span>, <span class="at">stop =</span> <span class="dv">2</span>))</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>My_Age_Heart_Data<span class="sc">$</span>Age_max <span class="ot">&lt;-</span> </span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.numeric</span>(<span class="fu">substr</span>(My_Age_Heart_Data<span class="sc">$</span>Age_Category, <span class="at">start =</span> <span class="dv">4</span>, <span class="at">stop =</span> <span class="dv">5</span>))</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>Number_ofparticipants){</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># if (is.na(My_Age_Heart_Data$Age_min[i])){</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   My_Age_Heart_Data$Age_min[i] = My_Age_Heart_Data$Age_max[i]}</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.na</span>(My_Age_Heart_Data<span class="sc">$</span>Age_max[i])){</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>    My_Age_Heart_Data<span class="sc">$</span>Age_max[i] <span class="ot">=</span> My_Age_Heart_Data<span class="sc">$</span>Age_min[i]}</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a><span class="do">## We check if there were other missing age value included in the data.</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>more_missing_agevalue <span class="ot">&lt;-</span> Data_total<span class="sc">$</span>Age_Category[(<span class="fu">is.na</span>(My_Age_Heart_Data<span class="sc">$</span>Age_max))]</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a><span class="do">## Since all the missing values were participants 80 and older, we replace those missing values with 80.</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>My_Age_Heart_Data<span class="sc">$</span>Age_max[(<span class="fu">is.na</span>(My_Age_Heart_Data<span class="sc">$</span>Age_max))] <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="dv">80</span>)</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a><span class="co"># This code gives me the final age value to be used in the analysis.</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>My_Age_Heart_Data<span class="sc">$</span>FinalAge <span class="ot">&lt;-</span> </span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>  (My_Age_Heart_Data<span class="sc">$</span>Age_min <span class="sc">+</span> My_Age_Heart_Data<span class="sc">$</span>Age_max)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(My_Age_Heart_Data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Age_Category Heart_Disease Age_min Age_max FinalAge
1        65-69           Yes      65      69       67
2        70-74           Yes      70      74       72
3        40-44           Yes      40      44       42
4        55-59           Yes      55      59       57
5          80+           Yes      80      80       80
6        50-54           Yes      50      54       52</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Adding cleaned Age data in the data</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>Data_total<span class="sc">$</span>FinalAge <span class="ot">&lt;-</span> My_Age_Heart_Data<span class="sc">$</span>FinalAge</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(Data_total<span class="sc">$</span>FinalAge))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
</section>
<section id="converting-the-variables-that-are-in-character-form-to-factors" class="level3">
<h3 class="anchored" data-anchor-id="converting-the-variables-that-are-in-character-form-to-factors">Converting the variables that are in character form to factors</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>Data_total<span class="sc">$</span>Diabetes <span class="ot">&lt;-</span> <span class="fu">factor</span>(Data_total<span class="sc">$</span>Diabetes)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>Data_total<span class="sc">$</span>Checkup <span class="ot">&lt;-</span> <span class="fu">factor</span>(Data_total<span class="sc">$</span>Checkup)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>Data_total<span class="sc">$</span>General_Health <span class="ot">&lt;-</span> <span class="fu">factor</span>(Data_total<span class="sc">$</span>General_Health)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>Data_total<span class="sc">$</span>Arthritis <span class="ot">&lt;-</span> <span class="fu">factor</span>(Data_total<span class="sc">$</span>Arthritis)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>Data_total<span class="sc">$</span>Sex <span class="ot">&lt;-</span> <span class="fu">factor</span>(Data_total<span class="sc">$</span>Sex)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>Data_total<span class="sc">$</span>Smoking_History <span class="ot">&lt;-</span> <span class="fu">factor</span>(Data_total<span class="sc">$</span>Smoking_History)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>Data_total<span class="sc">$</span>Height_.cm. <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(Data_total<span class="sc">$</span>Height_.cm.)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>Data_total<span class="sc">$</span>Skin_Cancer <span class="ot">&lt;-</span> <span class="fu">factor</span>(Data_total<span class="sc">$</span>Skin_Cancer)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>Data_total<span class="sc">$</span>Other_Cancer <span class="ot">&lt;-</span> <span class="fu">factor</span>(Data_total<span class="sc">$</span>Other_Cancer)</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>Data_total<span class="sc">$</span>Exercise <span class="ot">&lt;-</span> <span class="fu">factor</span>(Data_total<span class="sc">$</span>Exercise)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>Data_total<span class="sc">$</span>Depression <span class="ot">&lt;-</span> <span class="fu">factor</span>(Data_total<span class="sc">$</span>Depression)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="final-pre-processed-data" class="level3">
<h3 class="anchored" data-anchor-id="final-pre-processed-data">Final Pre-processed data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Here we will remove the Diabetes column that do not make sense to us. </span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>Extra_DiabetesandnullAge_Column <span class="ot">&lt;-</span> </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">which</span>((Data_total<span class="sc">$</span>Diabetes <span class="sc">==</span> <span class="st">"Yes, but female told only during pregnancy"</span>) <span class="sc">|</span> </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>          (Data_total<span class="sc">$</span>Diabetes <span class="sc">==</span> <span class="st">"No, pre-diabetes or borderline diabetes"</span>))</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="do">## This is our final data with clean variables</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>Data_total <span class="ot">&lt;-</span> Data_total[<span class="sc">-</span>Extra_DiabetesandnullAge_Column, ]</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>Data_total<span class="sc">$</span>Diabetes <span class="ot">&lt;-</span> <span class="fu">factor</span>(Data_total<span class="sc">$</span>Diabetes)</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>Data_total<span class="sc">$</span>Age_Category <span class="ot">&lt;-</span> <span class="cn">NULL</span> <span class="co"># removing age category</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(Data_total)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   19323 obs. of  19 variables:
 $ General_Health              : Factor w/ 5 levels "Excellent","Fair",..: 4 2 2 2 4 2 5 3 5 2 ...
 $ Checkup                     : Factor w/ 5 levels "5 or more years ago",..: 5 5 5 5 5 5 5 5 5 5 ...
 $ Exercise                    : Factor w/ 2 levels "No","Yes": 2 2 2 1 1 2 2 2 2 2 ...
 $ Heart_Disease               : chr  "Yes" "Yes" "Yes" "Yes" ...
 $ Skin_Cancer                 : Factor w/ 2 levels "No","Yes": 2 1 1 1 1 1 1 1 1 1 ...
 $ Other_Cancer                : Factor w/ 2 levels "No","Yes": 1 1 1 2 1 1 1 1 1 1 ...
 $ Depression                  : Factor w/ 2 levels "No","Yes": 1 1 1 1 2 1 2 1 1 1 ...
 $ Diabetes                    : Factor w/ 2 levels "No","Yes": 2 2 2 2 1 1 1 2 1 1 ...
 $ Arthritis                   : Factor w/ 2 levels "No","Yes": 2 2 2 2 2 1 2 2 2 1 ...
 $ Sex                         : Factor w/ 2 levels "Female","Male": 2 2 1 1 2 2 2 2 1 1 ...
 $ Height_.cm.                 : num  175 170 180 160 155 180 185 163 163 173 ...
 $ Weight_.kg.                 : num  103 104.3 136.1 65.8 62.6 ...
 $ BMI                         : num  33.5 36 41.8 25.7 26.1 ...
 $ Smoking_History             : Factor w/ 2 levels "No","Yes": 2 2 2 1 2 1 2 1 1 2 ...
 $ Alcohol_Consumption         : num  0 0 5 0 0 25 1 2 1 2 ...
 $ Fruit_Consumption           : num  12 60 60 12 28 3 4 30 12 16 ...
 $ Green_Vegetables_Consumption: num  16 30 2 12 28 4 10 8 12 2 ...
 $ FriedPotato_Consumption     : num  3 4 12 3 4 8 12 3 4 12 ...
 $ FinalAge                    : num  67 72 42 57 80 52 67 72 77 62 ...</code></pre>
</div>
</div>
</section>
<section id="dependent-variable-vs-independent-variable-of-the-model" class="level3">
<h3 class="anchored" data-anchor-id="dependent-variable-vs-independent-variable-of-the-model">Dependent variable vs independent variable of the model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="do">## independent Variables</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>InputtoHeartDisease_Model2 <span class="ot">&lt;-</span> </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(Data_total<span class="sc">$</span>Fruit_Consumption, Data_total<span class="sc">$</span>Alcohol_Consumption,</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  Data_total<span class="sc">$</span>Green_Vegetables_Consumption, Data_total<span class="sc">$</span>FriedPotato_Consumption,</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  Data_total<span class="sc">$</span>FinalAge, Data_total<span class="sc">$</span>BMI, Data_total<span class="sc">$</span>Diabetes,</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  Data_total<span class="sc">$</span>Checkup, Data_total<span class="sc">$</span>General_Health, Data_total<span class="sc">$</span>Arthritis,</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  Data_total<span class="sc">$</span>Sex, Data_total<span class="sc">$</span>Smoking_History, Data_total<span class="sc">$</span>Height_.cm.,</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  Data_total<span class="sc">$</span>Weight_.kg.,Data_total<span class="sc">$</span>Skin_Cancer, Data_total<span class="sc">$</span>Other_Cancer, </span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  Data_total<span class="sc">$</span>Exercise, Data_total<span class="sc">$</span>Depression)</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(InputtoHeartDisease_Model2) <span class="ot">&lt;-</span> </span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">"Fruit"</span>, <span class="st">"Alcohol"</span>, <span class="st">"GreenVeggie"</span>, <span class="st">"FriedPotato"</span>,</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">"FinalAge"</span>, <span class="st">"BMI"</span>, <span class="st">"Diabetes"</span>, <span class="st">"Checkup"</span>, <span class="st">"GeneralHealth"</span>, </span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Arthritis"</span>, <span class="st">"Sex"</span>, <span class="st">"SmokingHistory"</span>, <span class="st">"Height_.cm"</span>, </span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Weight_.kg."</span>,<span class="st">"SkinCancer"</span>, <span class="st">"OtherCancer"</span>, <span class="st">"Exercise"</span>, <span class="st">"Depression"</span>)</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a><span class="do">## Dependent Variable</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>Heart_label <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(Data_total<span class="sc">$</span>Heart_Disease)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="partitioning-of-the-data-into-trainingtesting-for-random-forest-model" class="level3">
<h3 class="anchored" data-anchor-id="partitioning-of-the-data-into-trainingtesting-for-random-forest-model">Partitioning of the data into training/testing for random forest model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">222</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>sample_data <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(InputtoHeartDisease_Model2), .<span class="dv">7</span><span class="sc">*</span> <span class="fu">nrow</span>(InputtoHeartDisease_Model2))</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>train_data <span class="ot">&lt;-</span> InputtoHeartDisease_Model2[sample_data, ]</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> InputtoHeartDisease_Model2[<span class="sc">-</span>sample_data, ]</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>HeartLabel_Train <span class="ot">&lt;-</span> Heart_label[sample_data]</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>HeartLabel_Test <span class="ot">&lt;-</span> Heart_label[<span class="sc">-</span>sample_data]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="running-the-model" class="level1">
<h1>Running the model</h1>
<section id="this-is-our-random-forest-model-with-all-features" class="level3">
<h3 class="anchored" data-anchor-id="this-is-our-random-forest-model-with-all-features">This is our random forest model with all features</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>our_model_500 <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(HeartLabel_Train <span class="sc">~</span> ., <span class="at">data =</span> train_data, <span class="at">ntree =</span> <span class="dv">500</span>, </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>                              <span class="at">proximity =</span> T, <span class="at">mtry =</span> <span class="dv">3</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>our_model_500</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
 randomForest(formula = HeartLabel_Train ~ ., data = train_data,      ntree = 500, proximity = T, mtry = 3) 
               Type of random forest: classification
                     Number of trees: 500
No. of variables tried at each split: 3

        OOB estimate of  error rate: 24.44%
Confusion matrix:
      No  Yes class.error
No  4775 1973   0.2923829
Yes 1333 5445   0.1966657</code></pre>
</div>
</div>
</section>
<section id="parameter-tuning" class="level3">
<h3 class="anchored" data-anchor-id="parameter-tuning">Parameter Tuning</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Parameter Tuning A: here we find the optimal number of decision trees</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(our_model_500, <span class="at">log =</span> <span class="st">"y"</span>, <span class="at">main =</span> <span class="st">"All-features: Error rate as a function </span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="st">     of  ntrees (= 500)"</span>, <span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">0.2</span>,<span class="fl">0.8</span>))</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"top"</span>, <span class="fu">colnames</span>(our_model_500<span class="sc">$</span>err.rate), <span class="at">col =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">fill =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ProjectCode_files/figure-html/J-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="do">## This is our random forest model with all features</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>our_model_1000 <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(HeartLabel_Train <span class="sc">~</span> ., <span class="at">data =</span> train_data, <span class="at">ntree =</span> <span class="dv">1000</span>, </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">proximity =</span> T, <span class="at">mtry =</span> <span class="dv">3</span>)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>our_model_1000</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
 randomForest(formula = HeartLabel_Train ~ ., data = train_data,      ntree = 1000, proximity = T, mtry = 3) 
               Type of random forest: classification
                     Number of trees: 1000
No. of variables tried at each split: 3

        OOB estimate of  error rate: 24.35%
Confusion matrix:
      No  Yes class.error
No  4786 1962   0.2907528
Yes 1332 5446   0.1965181</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(our_model_1000, <span class="at">log =</span> <span class="st">"y"</span>, <span class="at">main =</span> <span class="st">"All-features: Error rate as a function </span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="st">     of  ntrees (= 1000)"</span>, <span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">0.2</span>,<span class="fl">0.8</span>))</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"top"</span>, <span class="fu">colnames</span>(our_model_1000<span class="sc">$</span>err.rate), <span class="at">col =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">fill =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ProjectCode_files/figure-html/J-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Parameter Tuning B: now we will find the optimal number of split of the tree</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>oob_values <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length =</span> <span class="dv">10</span>)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) {</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  Num_model <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(HeartLabel_Train <span class="sc">~</span> ., <span class="at">data =</span> train_data, <span class="at">mtry =</span> i, <span class="at">ntree =</span> <span class="dv">500</span>)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  oob_values[i] <span class="ot">&lt;-</span> Num_model<span class="sc">$</span>err.rate[<span class="fu">nrow</span>(Num_model<span class="sc">$</span>err.rate), <span class="dv">1</span>]</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(oob_values, <span class="at">main =</span> <span class="st">"Error rate as a function of Num of Nodes"</span>, <span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">bty =</span> <span class="st">"n"</span>,</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">0.2</span>,<span class="fl">0.8</span>), <span class="at">col =</span> <span class="dv">2</span>, <span class="at">xlab =</span> <span class="st">"Nodes"</span>, <span class="at">ylab =</span> <span class="st">"OOB Rate"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ProjectCode_files/figure-html/J-3.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="we-will-record-the-out-of-bag-error-estimate-of-the-optimal-model" class="level3">
<h3 class="anchored" data-anchor-id="we-will-record-the-out-of-bag-error-estimate-of-the-optimal-model">We will record the out of bag error estimate of the optimal model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>our_model_500 <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(HeartLabel_Train <span class="sc">~</span> ., <span class="at">data =</span> train_data, <span class="at">ntree =</span> <span class="dv">500</span>, </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>                              <span class="at">proximity =</span> T, <span class="at">mtry =</span> <span class="dv">2</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>our_model_500</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
 randomForest(formula = HeartLabel_Train ~ ., data = train_data,      ntree = 500, proximity = T, mtry = 2) 
               Type of random forest: classification
                     Number of trees: 500
No. of variables tried at each split: 2

        OOB estimate of  error rate: 24.43%
Confusion matrix:
      No  Yes class.error
No  4726 2022   0.2996443
Yes 1282 5496   0.1891413</code></pre>
</div>
</div>
</section>
</section>
<section id="model-features-and-performance" class="level1">
<h1>Model Features and Performance</h1>
<section id="model-performance-on-the-testing-and-training-set" class="level3">
<h3 class="anchored" data-anchor-id="model-performance-on-the-testing-and-training-set">Model Performance on the testing and training set</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Testing the model accuracy on the training data</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>train_rf <span class="ot">&lt;-</span> <span class="fu">predict</span>(our_model_500, train_data)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>Train_Summary <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(train_rf, HeartLabel_Train)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>Train_Summary</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   No  Yes
       No  6091  384
       Yes  657 6394
                                          
               Accuracy : 0.923           
                 95% CI : (0.9184, 0.9275)
    No Information Rate : 0.5011          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.8461          
                                          
 Mcnemar's Test P-Value : &lt; 2.2e-16       
                                          
            Sensitivity : 0.9026          
            Specificity : 0.9433          
         Pos Pred Value : 0.9407          
         Neg Pred Value : 0.9068          
             Prevalence : 0.4989          
         Detection Rate : 0.4503          
   Detection Prevalence : 0.4787          
      Balanced Accuracy : 0.9230          
                                          
       'Positive' Class : No              
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Testing the model accuracy on the testing data</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>test_rf <span class="ot">&lt;-</span> <span class="fu">predict</span>(our_model_500, test_data)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>Test_Summary <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(test_rf, HeartLabel_Test)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>Test_Summary <span class="do">## All features</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   No  Yes
       No  2022  541
       Yes  904 2330
                                          
               Accuracy : 0.7507          
                 95% CI : (0.7394, 0.7618)
    No Information Rate : 0.5047          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.502           
                                          
 Mcnemar's Test P-Value : &lt; 2.2e-16       
                                          
            Sensitivity : 0.6910          
            Specificity : 0.8116          
         Pos Pred Value : 0.7889          
         Neg Pred Value : 0.7205          
             Prevalence : 0.5047          
         Detection Rate : 0.3488          
   Detection Prevalence : 0.4421          
      Balanced Accuracy : 0.7513          
                                          
       'Positive' Class : No              
                                          </code></pre>
</div>
</div>
</section>
<section id="which-variables-are-most-important-according-to-our-model" class="level3">
<h3 class="anchored" data-anchor-id="which-variables-are-most-important-according-to-our-model">Which variables are most important according to our model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("ggalt")</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>({</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(ggalt)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(randomForest)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(data.table)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Here we get a nice looking plot for the feature important index</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>imp <span class="ot">&lt;-</span> <span class="fu">data.table</span>(<span class="fu">importance</span>(our_model_500), <span class="at">keep.rownames =</span> <span class="cn">TRUE</span>)</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>imp <span class="ot">=</span> <span class="fu">arrange</span>(imp, MeanDecreaseGini)</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>imp[, rn <span class="sc">:</span><span class="er">=</span> <span class="fu">factor</span>(rn, <span class="fu">unique</span>(rn))]</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">melt</span>(imp, <span class="at">id.vars=</span><span class="st">"rn"</span>)[<span class="fu">grep</span>(<span class="st">"Mean"</span>, variable)], </span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span>rn, <span class="at">y=</span>value, <span class="at">label =</span> <span class="fu">round</span>(value, <span class="dv">1</span>))) <span class="sc">+</span> </span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_lollipop</span>(<span class="at">point.size =</span> <span class="dv">4</span>, <span class="at">point.colour =</span> <span class="st">"orange3"</span>, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">bg =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">nudge_y =</span> <span class="dv">2</span>), <span class="at">hjust =</span> <span class="sc">-</span>.<span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>  <span class="co">#facet_wrap(~variable) +</span></span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"MeanDecreaseGini"</span>, <span class="at">x=</span><span class="cn">NULL</span>, </span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"Feature Importance Plot from Cardio Vascular Dataset"</span>, <span class="at">cex =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="dv">1300</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in geom_text(aes(nudge_y = 2), hjust = -0.3): Ignoring unknown
aesthetics: nudge_y</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using the `size` aesthetic with geom_segment was deprecated in ggplot2 3.4.0.
ℹ Please use the `linewidth` aesthetic instead.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="ProjectCode_files/figure-html/M-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="partial-depedence-plot" class="level3">
<h3 class="anchored" data-anchor-id="partial-depedence-plot">Partial Depedence Plot</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Partial Dependence Plot</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Age</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>Age <span class="ot">&lt;-</span> <span class="fu">partialPlot</span>(our_model_500, <span class="at">pred.data =</span> train_data, FinalAge, <span class="st">"Yes"</span>, <span class="at">lwd =</span> <span class="dv">3</span>, </span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylab =</span> <span class="st">"Partial depedence"</span>, <span class="at">col =</span> <span class="st">"pink3"</span>, <span class="at">main =</span> <span class="fu">substitute</span>(<span class="fu">bold</span>(<span class="st">"Age (in years)"</span>)),</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="fl">1.5</span>), <span class="at">bty=</span><span class="st">"n"</span>, <span class="at">cex.main =</span> <span class="dv">2</span>)</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="fu">c</span>(<span class="dv">2</span>), <span class="at">font =</span> <span class="dv">4</span>)</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="fu">c</span>(<span class="dv">1</span>), <span class="at">font =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ProjectCode_files/figure-html/N-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Weight</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>Weight <span class="ot">&lt;-</span> <span class="fu">partialPlot</span>(our_model_500,  <span class="at">pred.data =</span> train_data, <span class="at">x.var =</span> Weight_.kg., <span class="st">"Yes"</span>, <span class="at">lwd =</span> <span class="dv">3</span>, </span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">"Partial depedence"</span>, <span class="at">main =</span> <span class="fu">substitute</span>(<span class="fu">bold</span>(<span class="st">"Weight (in kg)"</span>)),</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">col =</span> <span class="st">"darkgrey"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>,.<span class="dv">1</span>), <span class="at">cex.main =</span> <span class="dv">2</span>) </span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="fu">c</span>(<span class="dv">2</span>), <span class="at">font =</span> <span class="dv">4</span>)</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="fu">c</span>(<span class="dv">1</span>), <span class="at">font =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ProjectCode_files/figure-html/N-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="do">## BMI</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>BMI <span class="ot">&lt;-</span> <span class="fu">partialPlot</span>(our_model_500, <span class="at">pred.data =</span> train_data, BMI, <span class="st">"Yes"</span>, <span class="at">lwd =</span> <span class="dv">4</span>, </span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">"Partial depedence"</span>, <span class="at">main =</span> <span class="fu">substitute</span>(<span class="fu">bold</span>(<span class="st">"BMI"</span>)),</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="st">"tan"</span>, <span class="at">bty =</span> <span class="st">"n"</span>,<span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.2</span>, .<span class="dv">2</span>), <span class="at">cex.main =</span> <span class="dv">2</span>) </span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="fu">c</span>(<span class="dv">2</span>), <span class="at">font =</span> <span class="dv">4</span>)</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="fu">c</span>(<span class="dv">1</span>), <span class="at">font =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ProjectCode_files/figure-html/N-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="do">## General Health</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="co">#par(mfrow = c(1, 2))</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>GenHealth <span class="ot">&lt;-</span> <span class="fu">partialPlot</span>(our_model_500, <span class="at">pred.data =</span> train_data, GeneralHealth, </span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Yes"</span>, <span class="at">lwd =</span> <span class="dv">4</span>, </span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">ylab =</span> <span class="st">"Partial depedence"</span>, <span class="at">main =</span> <span class="st">"General Health"</span>,</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>), <span class="at">cex.main =</span> <span class="dv">2</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ProjectCode_files/figure-html/N-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Height</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>Height <span class="ot">&lt;-</span> <span class="fu">partialPlot</span>(our_model_500,  <span class="at">pred.data =</span> train_data, <span class="at">x.var =</span> Height_.cm, </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Yes"</span>, <span class="at">lwd =</span> <span class="dv">4</span>, <span class="at">ylab =</span> <span class="st">"Partial depedence"</span>, </span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">main =</span> <span class="fu">substitute</span>(<span class="fu">bold</span>(<span class="st">"Height (in cm)"</span>)), <span class="at">col =</span> <span class="st">"brown2"</span>,</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>,.<span class="dv">1</span>), <span class="at">cex.main =</span> <span class="dv">2</span>)</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="fu">c</span>(<span class="dv">2</span>), <span class="at">font =</span> <span class="dv">3</span>)</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="fu">c</span>(<span class="dv">1</span>), <span class="at">font =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ProjectCode_files/figure-html/N-5.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Food Habits——</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="co">#par(mfrow = c(1,3))</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="co">#par(font.axis = 2)</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Fruits</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>Fruits <span class="ot">&lt;-</span> <span class="fu">partialPlot</span>(our_model_500,  <span class="at">pred.data =</span> train_data, <span class="at">x.var =</span> Fruit, </span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Yes"</span>, <span class="at">lwd =</span> <span class="dv">4</span>, <span class="at">ylab =</span> <span class="st">"Partial depedence"</span>, </span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="fu">substitute</span>(<span class="fu">bold</span>(<span class="st">"Fruit Eating Habits"</span>)),<span class="at">bty =</span> <span class="st">"n"</span>, </span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">col =</span> <span class="st">"orange2"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>,.<span class="dv">1</span>), <span class="at">cex.main =</span> <span class="dv">2</span>) </span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="fu">c</span>(<span class="dv">2</span>), <span class="at">font =</span> <span class="dv">3</span>)</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="fu">c</span>(<span class="dv">1</span>), <span class="at">font =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ProjectCode_files/figure-html/N-6.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Vegetables</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>Veggie <span class="ot">&lt;-</span> <span class="fu">partialPlot</span>(our_model_500,  <span class="at">pred.data =</span> train_data, <span class="at">x.var =</span> GreenVeggie, </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Yes"</span>, <span class="at">lwd =</span> <span class="dv">4</span>, <span class="at">ylab =</span> <span class="st">"Partial depedence"</span>, </span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="fu">substitute</span>(<span class="fu">bold</span>(<span class="st">"Veggie Eating Habits"</span>)),</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">col =</span> <span class="st">"green4"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">1</span>,.<span class="dv">1</span>), <span class="at">cex.main =</span> <span class="dv">2</span>) </span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="fu">c</span>(<span class="dv">2</span>), <span class="at">font =</span> <span class="dv">3</span>)</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="fu">c</span>(<span class="dv">1</span>), <span class="at">font =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ProjectCode_files/figure-html/N-7.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Friedpotatoes</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>FriedPotatoes <span class="ot">&lt;-</span> <span class="fu">partialPlot</span>(our_model_500,  <span class="at">pred.data =</span> train_data, </span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">x.var =</span> FriedPotato, <span class="st">"Yes"</span>, <span class="at">lwd =</span> <span class="dv">4</span>, <span class="at">ylab =</span> <span class="st">"Partial depedence"</span>, </span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">main =</span> <span class="fu">substitute</span>(<span class="fu">bold</span>(<span class="st">"Fried-Potatoes Eating Habits"</span>)),</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">col =</span> <span class="st">"yellow2"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>,.<span class="dv">1</span>), <span class="at">cex.main =</span> <span class="dv">2</span>) </span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="fu">c</span>(<span class="dv">2</span>), <span class="at">font =</span> <span class="dv">3</span>)</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="fu">c</span>(<span class="dv">1</span>), <span class="at">font =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ProjectCode_files/figure-html/N-8.png" class="img-fluid" width="672"></p>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>